language: node_js
node_js:
- '4'

script:
- ./node_modules/.bin/webdriver-manager update --standalone
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- nohup bash -c "./node_modules/.bin/webdriver-manager --standalone start 2>&1 &"
- sleep 5
- cat nohup.out

- npm test

after_success:
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "master"
- ./node_modules/.bin/istanbul cover jasmine-node --captureExceptions spec/
- ./node_modules/.bin/codecov
- mkdir -p _site
- curl -sSf https://static.rust-lang.org/rustup.sh | sh
- curl -L https://github.com/yihui/ubuntu-bin/releases/download/latest/pandoc.tar.gz | tar zx
- pandoc -o _site/index.html README.md
- cp -r img _site
- bash deploy.sh

env:
  global:
    secure: P0TDENqxPWhWtyNa/pJxjUELE5fWN/1+mUp7Rli/OaRVvM3mM7kAK7ssgRl7ymXFNMaUMdZisMnI1GLmK33YWV0KDkqzEopxiKtLyPGwaBNxq+GumIP86EQz8R4ZcrzYTXjZH8VjxxfZynEYsva0lp98/Z/53QiOokGPSgVFPmCSzv3ot8GtzJZsFuCMQ44xerH5WuuSNuqfMKHCQT401xqJRnKM7a623WYAV43vDyT2wrvOysWWi7uBRYC+yUc3VonzMchk63jKCQoAdbt5yo3ELEi75uuJyLVoxuT3ejxCxNybbpjVtBXp/9tdSzygF6fk0vowsWczWpEu9065a+G3rTplc2uRqwWzuLMa5hgIAG3QNPdwHDnhZvYLTzLzF0VXUCIncmumOgSf/xtXfaJBUwSLZMEKEqqvx6KvhId5bu9VQJ+3aJb+fzdzwWh+dhG8G5Dd30D2fnoIdA9D+TLtOJrzsWFUZuCzp2bZuyZa5BT9BAGJwADTQdPlYJVeBRPacWKRKaEVzV7jjDhapI69xoxUNzNgVn9ksH7RGAVAjfyEyuN4SUMlwQitXk5+8jxzCrP76c3rRN1P3uuBp74+zXYN9YMvKvLYCzMRvrqoHC9EvO8ZBI31yHNOQ5j71cDjDktwdIlKYzKwWBRYnFl3neg/DB8GOXbIQW7zITQ=

cache:
  directories:
  - node_modules 
